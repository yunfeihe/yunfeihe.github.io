parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({7:[function(require,module,exports) {
"use strict";function e(e){if(e>0){for(var t=(new Date).getTime();;){if((new Date).getTime()-t>=e)break}console.log("已经过去"+e+"ms")}}exports.__esModule=!0,exports.default={sleep:e,randomBetween:function(e,t){var a=[Math.max(e,t),Math.min(e,t)],n=a[1],o=n+(a[0]-n)*Math.random();return Math.round(o)}};
},{}],4:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var n=e(require("./utils")),o=[0,0],i=[1,100],r=[0,200],s=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.storage=[],this.storage.concat(this.storage)}return t.prototype.add=function(t){this.storage.push(t),this.freshEl()},t.prototype.offer=function(){var t=this.storage.shift();return this.freshEl(),t},t.prototype.isEmpty=function(){return 0===this.storage.length},t.prototype.showIn=function(t,e){void 0===e&&(e="Queue"),this.name=e,this.element=document.createElement("div"),t.appendChild(this.element),this.freshEl()},t.prototype.freshEl=function(){if(void 0!==this.element){var t="["+this.storage.join("<-")+"]";this.element.textContent=this.name+": "+t}},t}(),u=1e3,a=function(){var t=new Date;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=new Date;if(t=o,e.push(t.toLocaleTimeString()+": "+t.getSeconds()),e.join("").indexOf("debug"),!(e.join("").indexOf("while")>-1))return console.log.apply(console,e)}}(),f=function(){function t(){this.mapElement=document.createElement("div"),this.mapElement.classList.add("item"),this.position=[0,0],document.querySelector("#stage").appendChild(this.mapElement)}return t.prototype.setTextcontent=function(t){this.__originalText=t,this.mapElement.textContent=t},t.prototype.setStatus=function(t){this.mapElement.textContent=this.__originalText+"("+t+")"},t.prototype.getPosition=function(){return this.position},t.prototype.moveTo=function(t,e){var n=this;void 0===e&&(e=1),null===t[0]&&(t[0]=this.position[0]),null===t[1]&&(t[1]=this.position[1]),this.position=t,Promise.resolve(e).then(function(t){var e=n.mapElement;return e.style.transition=t+"s",e}).then(function(e){setTimeout(function(){e.style.transform="translate("+t[0]+"px, "+t[1]+"px)"},0)})},t.prototype.moveToServeBar=function(t){void 0===t&&(t=1);i[0];var e=i[1];return this.moveTo([null,e],t),new Promise(function(e){setTimeout(function(){e("ok")},t*u)})},t}(),h=function(e){function n(t,n){var o=e.call(this)||this;return o.name=t,o.payment=n,o.setTextcontent(t),o}return t(n,e),n.prototype.toString=function(){return this.name},n}(f),c=function(e){function i(t,i){var r=e.call(this,t,i)||this,s=o[0],u=o[1];return r.moveTo([s+n.default.randomBetween(0,300),u+n.default.randomBetween(20,80)]),r}return t(i,e),i.prototype.setFinishedDishQueue=function(t){this.finishedDishQueue=t},i.prototype.makeDish=function(t){for(var e=function(){function t(t,e){this.dish=t,this.customer=e}return t.prototype.toString=function(){return this.customer.name+"的"+this.dish.name},t}(),o=this,i=[],r=function(r){var f=new Promise(function(n,o){setTimeout(function(){console.log("做好了"+r.name);var o=new e(r,t.customer);n(o)},r.time*u)}).then(function(t){a("*"),o.finishedDishQueue.add(t)}),h=s.getPosition(),c=h[0],d=h[1];s.moveTo([c+n.default.randomBetween(-100,50),d+n.default.randomBetween(-20,20)]),i.push(f)},s=this,f=0,h=t.dishes;f<h.length;f++){r(h[f])}return Promise.all(i)},i}(h),d=function(e){function o(t,o){var r=e.call(this,t,o)||this;r.order=null,r.setStatus("空闲中");i[0];var s=i[1];return r.moveTo([n.default.randomBetween(0,200),s+n.default.randomBetween(20,60)]),r}return t(o,e),o.prototype.setFinishedDishQueue=function(t){this.finishedDishQueue=t},o.prototype.takeOrder=function(t){var e=this;return this.setStatus("为"+t.customer.name+"点菜中"),new Promise(function(n,o){var i=t.customer.getPosition();e.moveTo(i,.5),setTimeout(function(){n(e)},.5*u)}).then(function(n){return new Promise(function(n){setTimeout(function(){e.order=t,n("ok")},3*u)})})},o.prototype.writeDownOrder=function(t){var e=this;return new Promise(function(n){e.setStatus("通知厨师上菜"),e.moveTo([null,150],.5),setTimeout(function(){t.add(e.order),e.order=null,n("ok")},.5*u)})},o}(h),m=function(){function t(){}return t.getStaff=function(t,e){return"cook"===t?new c(e[0],e[1]):"waiter"===t?new d(e[0],e[1]):void 0},t}(),l=function(e){function o(t){var o=e.call(this)||this;o.dishes=[],o.name=t,o.setTextcontent("顾客:"+o.name);var i=r[0],s=r[1];return o.moveTo([i+n.default.randomBetween(0,300),s+n.default.randomBetween(0,300)]),o}return t(o,e),o.prototype.order=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],o=0,i=t;o<i.length;o++){var r=i[o];n.push(p.getDish(r))}var s=new(v.bind.apply(v,[void 0,this].concat(n)));return this.__order=s,this},o.prototype.getOrder=function(){return this.__order},o.prototype.getDish=function(t){var e=this,n=this.__order.dishes.length;Promise.resolve(t).then(function(t){return e.dishes.push(t),t}).then(function(t){return new Promise(function(n,o){console.log(e.name+"开始吃"+t.name),setTimeout(function(){n(t)},2*u)})}).then(function(t){console.log(e.name+"吃完了"+t.name),e.dishes.length===n&&a(e.name+"已经全部吃完了")})},o.prototype.toString=function(){return this.name},o}(f),p=function(){function t(t,e,n,o){this.name=t,this.price=e,this.cost=n,this.time=2|o}return t.prototype.toString=function(){return"菜"+this.name},t.storage={},t.getDish=function(){for(var e=0,n=[new t("蟹黄堡",100,50),new t("fish",100,50,10),new t("duck",100,50),new t("drink",100,50),new t("cheaps",100,50),new t("potato",100,50),new t("meat",100,50)];e<n.length;e++){var o=n[e],i=o.name;t.storage[i]=o}return function(e){var n=t.storage[e];return void 0===n&&(n=new t(e,199,100),console.log("没有叫"+n.name+"的菜，但可以给你做 价格199")),n}}(),t}(),v=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.customer=t,this.dishes=e}return t.prototype.toString=function(){return this.customer.name+"的订单"},t}();function g(){var t=new l("派大星"),e=new l("阿银"),n=new l("路飞"),o=m.getStaff("waiter",["章鱼哥",1e3]),i=m.getStaff("waiter",["佩奇",1e3]),r=m.getStaff("cook",["海绵宝宝",0]),f=m.getStaff("cook",["阿秒小姐",9999]),h=m.getStaff("cook",["小当家",0]),c=new s,d=new s,p=new s,v=new s,g=new s,w=document.querySelector("#info");c.showIn(w,"正在要求点菜的顾客队列"),d.showIn(w,"空闲厨师队列"),p.showIn(w,"订单队列"),v.showIn(w,"空闲侍者队列"),g.showIn(w,"已完成菜品队列"),i.setFinishedDishQueue(g),o.setFinishedDishQueue(g),r.setFinishedDishQueue(g),f.setFinishedDishQueue(g),h.setFinishedDishQueue(g),d.add(r),d.add(f),d.add(h),v.add(o),v.add(i),c.add(t.order("fish","duck")),c.add(e.order("蛋黄酱","蛋黄酱","蛋黄酱","蛋黄酱","蛋黄酱")),c.add(n.order("肉","肉","肉","肉","肉","肉"));var y=document.querySelector("#name"),S=document.querySelector("#dishes");document.querySelector("#btn").addEventListener("click",function(){var t=new l(y.value),e=S.value.split(" ");t.order.apply(t,e),c.add(t)}),function e(n){void 0===n&&(n=u),setTimeout(function(){for(var n=function(){if(a("while1"),c.isEmpty()){if(a("debug2"),g.isEmpty())return a("debug4"),"break";a("debug3");var e=v.offer();e.setStatus("准备上菜中");var n=g.offer();e.moveToServeBar(.5).then(function(){var t=n.customer;return e.setStatus(t.name+"的"+n.dish.name),a("cus",t.getPosition()),e.moveTo(t.getPosition(),1),new Promise(function(t){setTimeout(function(){t(n.dish)},1*u)})}).then(function(n){a("dish",n),t.getDish(n),e.setStatus("空闲中"),e.moveToServeBar(),v.add(e)})}else{a("debug1");var o=v.offer(),i=c.offer(),r=i.getOrder();a(o.name+"准备"+i.name+"的点餐"),o.takeOrder(r).then(function(t){o.writeDownOrder(p).then(function(){o.setStatus("空闲中"),v.add(o)})})}};!v.isEmpty();){if("break"===n())break}for(var o=function(){if(a("while2"),d.isEmpty())return a("没有空闲厨师"),"break";var t=p.offer(),e=d.offer();e.makeDish(t).then(function(){a("完成一个订单"),d.add(e)})};!p.isEmpty();){if("break"===o())break}e()},n)}()}g();
},{"./utils":7}]},{},[4])
//# sourceMappingURL=/mian.33d67ac9.map