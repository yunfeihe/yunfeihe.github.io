{"version":3,"sources":["utils.ts","mian.ts"],"names":[],"mappings":"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","file":"mian.33d67ac9.map","sourceRoot":"..","sourcesContent":["\r\nfunction sleep(time: number) {\r\n    if (time > 0) {\r\n        let timeA = new Date().getTime();\r\n        while(true) {\r\n            let timeB = new Date().getTime();\r\n            if((timeB - timeA) >= time) {\r\n                break;\r\n            }\r\n        }\r\n        console.log('已经过去' + time + 'ms');\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport default {\r\n    sleep,\r\n    randomBetween(a, b):number {\r\n        let [max, min] = [Math.max(a, b), Math.min(a, b)];\r\n        let result = min + ((max - min) * Math.random());\r\n        return Math.round(result);\r\n    }\r\n}","import utils from './utils';\r\n\r\n\r\nconst kitchen = [0, 0];\r\nconst serveBar = [1, 100];\r\nconst table = [0, 200];\r\n\r\nclass Queue<T> {\r\n    private name: string;\r\n    private storage: T[] = [];\r\n    private element: Element;\r\n    constructor(...args: T[]) {\r\n        this.storage.concat(this.storage);\r\n    }\r\n\r\n    add(item: T) {\r\n        this.storage.push(item);\r\n        this.freshEl();\r\n    }\r\n    \r\n    offer(): T {\r\n        let item: T = this.storage.shift();\r\n        this.freshEl();\r\n        return item;\r\n        \r\n    }\r\n\r\n    isEmpty(): boolean {\r\n        return this.storage.length === 0;\r\n    }\r\n\r\n    showIn(el: Element, name: string = 'Queue') {\r\n        this.name = name;\r\n        this.element = document.createElement('div');\r\n        el.appendChild(this.element);\r\n        this.freshEl();\r\n    }\r\n\r\n    freshEl() {\r\n        if(this.element !== undefined) {\r\n            let template = '[' + this.storage.join('<-') + ']';\r\n            this.element.textContent = this.name + ': ' + template;\r\n        }\r\n    }\r\n\r\n}\r\nconst timeRatio = 1000;\r\n\r\nlet log = (function() {\r\n    let time = new Date();\r\n    return function(...args) {\r\n        let newTime = new Date();\r\n        time = newTime;\r\n        args.push(time.toLocaleTimeString() + ': ' + time.getSeconds());\r\n        if(args.join('').indexOf('debug') > -1, args.join('').indexOf('while') > -1) {\r\n            return;\r\n        }\r\n        return console.log(...args);\r\n    }\r\n})();\r\n\r\nabstract class MapElement {\r\n    private mapElement: Element;\r\n    private position: [number, number];\r\n    private __originalText: string;\r\n\r\n    constructor() {\r\n        this.mapElement = document.createElement('div');\r\n        this.mapElement.classList.add('item');\r\n        this.position =  [0, 0];\r\n        document.querySelector('#stage').appendChild(this.mapElement);\r\n    }\r\n\r\n    setTextcontent(text: string) {\r\n        this.__originalText = text;\r\n        this.mapElement.textContent = text;\r\n    }\r\n\r\n    setStatus(status: string) {\r\n        this.mapElement.textContent = this.__originalText + `(${status})`;\r\n    }\r\n\r\n    getPosition() {\r\n        return this.position;\r\n    }\r\n\r\n    moveTo(pos: [number, number], time = 1) {\r\n        if(pos[0] === null) {\r\n            pos[0] = this.position[0];\r\n        }\r\n        if(pos[1] === null) {\r\n            pos[1] = this.position[1];\r\n        }\r\n\r\n        this.position = pos;\r\n        Promise.resolve(time)\r\n        .then((time: number) => {\r\n            let el = this.mapElement as any;\r\n            el.style.transition = time + 's';\r\n            return el;\r\n        })\r\n        .then((el) => {\r\n            setTimeout(() => {\r\n                el.style.transform = `translate(${pos[0]}px, ${pos[1]}px)`;\r\n            }, 0);\r\n        });\r\n    }\r\n\r\n    moveToServeBar(time = 1) {\r\n        let [x, y] = serveBar;\r\n        this.moveTo([null, y], time);\r\n        return new Promise((resolve) => {\r\n            setTimeout(function() {\r\n                resolve('ok');\r\n            }, time * timeRatio);\r\n        });\r\n    }\r\n}\r\n\r\n\r\nabstract class SuperStaff extends MapElement {\r\n    name: string;\r\n    payment: number;\r\n    constructor(nm: string, p: number) {\r\n        super();\r\n        this.name = nm;\r\n        this.payment = p;\r\n        this.setTextcontent(nm);\r\n        // this.moveTo([50, Math.floor(Math.random() * 100)], Math.floor(Math.random() * 10));    \r\n    }\r\n    toString(): string {\r\n        return this.name;\r\n    }\r\n}\r\n\r\nclass Cook extends SuperStaff {\r\n    \r\n    finishedDishQueue: Queue<{dish: Dish, customer: Customer}>;\r\n    \r\n    constructor(name: string, payment: number) {\r\n        super(name, payment);\r\n        \r\n\r\n        let [x, y] = kitchen;\r\n        this.moveTo([x + utils.randomBetween(0, 300), y + utils.randomBetween(20, 80)]);\r\n    }\r\n\r\n    setFinishedDishQueue(f: Queue<{dish: Dish, customer: Customer}>) {\r\n        this.finishedDishQueue = f;\r\n    }\r\n\r\n    makeDish(order: Order) {\r\n\r\n        class FinishedDish {\r\n            dish: Dish;\r\n            customer: Customer;\r\n\r\n            constructor(dish: Dish, customer: Customer) {\r\n                this.dish = dish;\r\n                this.customer = customer;\r\n            }\r\n\r\n            toString() {\r\n                return this.customer.name + '的' + this.dish.name;\r\n            }\r\n        }\r\n\r\n        let dishes = order.dishes;\r\n        let self = this;\r\n        let allP = [];\r\n        for(let dish of dishes) {\r\n            \r\n            let p = new Promise(function(resolve, reject) {\r\n                setTimeout(function() {\r\n                    console.log('做好了' + dish.name);\r\n                    let finishedDish = new FinishedDish(dish, order.customer);\r\n                    \r\n                    resolve(finishedDish);\r\n                }, dish.time * timeRatio);\r\n            }).then(function(finishedDish: {dish: Dish, customer: Customer}) {\r\n                log('*');\r\n                self.finishedDishQueue.add(finishedDish);\r\n            });\r\n\r\n            //---纯粹动画效果\r\n            let [x, y] = this.getPosition();\r\n            this.moveTo([x + utils.randomBetween(-100, 50),y + utils.randomBetween(-20, 20)]);\r\n            //---\r\n\r\n            allP.push(p);\r\n        }\r\n\r\n        \r\n        return Promise.all(allP);\r\n    }\r\n}\r\n\r\nclass Waiter extends SuperStaff {\r\n    finishedDishQueue: Queue<{dish: Dish, customer: Customer}>;\r\n\r\n    order: Order = null;\r\n    constructor(name: string, payment: number) {\r\n        super(name, payment);\r\n\r\n        this.setStatus('空闲中');\r\n        let [x, y] = serveBar;\r\n        this.moveTo([utils.randomBetween(0, 200), y + utils.randomBetween(20, 60)]);\r\n    }\r\n\r\n    setFinishedDishQueue(f: Queue<{dish: Dish, customer: Customer}>) {\r\n        this.finishedDishQueue = f;\r\n    }\r\n\r\n    takeOrder(order: Order) {\r\n        //移动到顾客哪里   0.5秒的移动\r\n        this.setStatus('为' + order.customer.name + '点菜中');\r\n        return new Promise((resolve, reject) => {\r\n            //0.5s移动到顾客哪里\r\n            let customerPos = order.customer.getPosition();\r\n            this.moveTo(customerPos, 0.5);\r\n            setTimeout(() => {\r\n                resolve(this);\r\n            } , 0.5 * timeRatio);\r\n        })\r\n        .then((waiter: Waiter) => {\r\n            //3s 听取顾客点菜\r\n            return new Promise((resolve) => {\r\n                setTimeout(() => {\r\n                    this.order = order;\r\n                    resolve('ok');\r\n                }, 3 * timeRatio);\r\n            })\r\n        })\r\n    }\r\n\r\n    writeDownOrder(orderQueue) {\r\n        //移动到服务区\r\n        return new Promise((resolve) => {\r\n            this.setStatus('通知厨师上菜');\r\n            this.moveTo([null, 150], 0.5);\r\n            setTimeout(() => {\r\n                orderQueue.add(this.order);\r\n                this.order = null;\r\n                resolve('ok');\r\n            }, 0.5 * timeRatio);\r\n        })\r\n        \r\n        \r\n    }\r\n}\r\n\r\nclass Staff {\r\n    static getStaff(kind: 'cook' | 'waiter', args: [string, number]): Cook | Waiter {\r\n        if(kind === 'cook') {\r\n            return new Cook(args[0], args[1]);\r\n        } else if (kind === 'waiter') {\r\n            return new Waiter(args[0], args[1]);\r\n        }\r\n    }\r\n}\r\n\r\nclass Customer extends MapElement {\r\n    name;\r\n    dishes: Dish[] = [];\r\n    private __order: Order;\r\n    constructor(name: string) {\r\n        super();\r\n        this.name = name;\r\n        this.setTextcontent('顾客:' + this.name);\r\n        let [x, y] = table;\r\n        this.moveTo([x + utils.randomBetween(0, 300), y + utils.randomBetween(0, 300)]);\r\n    }\r\n    \r\n\r\n    order(...dishName: string[]) {\r\n        let dishes: Dish[] = [];\r\n\r\n        for(let name of dishName) {\r\n            dishes.push(Dish.getDish(name));\r\n        }\r\n        let order = new Order(this, ...dishes);\r\n        this.__order = order;\r\n        return this;\r\n    };\r\n\r\n    getOrder() {\r\n        return this.__order;\r\n    }\r\n\r\n    getDish(dish: Dish) {\r\n        const numOfOrderDishes = this.__order.dishes.length;\r\n        Promise.resolve(dish)\r\n        .then((dish: Dish) => {\r\n            this.dishes.push(dish);\r\n            return dish;\r\n        })\r\n        .then((dish: Dish) => {\r\n            return new Promise((resolve, reject) => {\r\n                console.log(this.name + '开始吃' + dish.name)\r\n                setTimeout(function() {\r\n                    resolve(dish);\r\n                }, 2 * timeRatio);\r\n            })\r\n        })\r\n        .then((dish: Dish) => {\r\n            console.log(this.name + '吃完了' + dish.name);\r\n            if(this.dishes.length === numOfOrderDishes) {\r\n                log(this.name + '已经全部吃完了');\r\n            }\r\n        })\r\n    }\r\n\r\n    toString(): string {\r\n        return this.name;\r\n    }\r\n}\r\n\r\nclass Dish {\r\n    name: string;\r\n    price: number;\r\n    time: number;\r\n    private cost: number;\r\n    static storage = {};\r\n    \r\n    constructor(name: string, price: number, cost: number, time?: number) {\r\n        this.name = name;\r\n        this.price = price;\r\n        this.cost = cost;\r\n        this.time = time | 2;\r\n    }\r\n\r\n    static getDish = (function() {\r\n        const cost:number = 50;\r\n        let o1 = new Dish('蟹黄堡', 100, cost);\r\n        let o2 = new Dish('fish', 100, cost, 10);\r\n        let o3 = new Dish('duck', 100, cost);\r\n        let o4 = new Dish('drink', 100, cost);\r\n        let o5 = new Dish('cheaps', 100, cost);\r\n        let o6 = new Dish('potato', 100, cost);\r\n        let o7 = new Dish('meat', 100, cost);\r\n        for(let item of [o1, o2, o3, o4, o5, o6, o7]) {\r\n            let name = item.name;\r\n            Dish.storage[name] = item;\r\n        }\r\n\r\n        return function(name: string): Dish {\r\n            let item = Dish.storage[name];\r\n            if(item === undefined) {\r\n                item = new Dish(name, 199, 100);\r\n                console.log('没有叫' + item.name + '的菜，但可以给你做 价格199');\r\n            }\r\n            return item;\r\n        }\r\n    })();\r\n    \r\n    toString(): string {\r\n        return '菜' + this.name;\r\n    }\r\n}\r\n\r\nclass Order {\r\n    customer: Customer;\r\n    dishes: Dish[];\r\n    constructor(c: Customer, ...dishes: Dish[]) {\r\n        this.customer = c;\r\n        this.dishes = dishes;\r\n    }\r\n    toString() {\r\n        return this.customer.name + '的订单';\r\n    }\r\n    \r\n}\r\n\r\nfunction main() {\r\n\r\n    \r\n    \r\n\r\n    let customer = new Customer('派大星');\r\n    let customer1 = new Customer('阿银');\r\n    let customer2 = new Customer('路飞');\r\n    // customer.moveTo([0, 220], 0);\r\n\r\n    let waiter = Staff.getStaff('waiter',['章鱼哥', 1000]) as Waiter;\r\n    let waiter2 = Staff.getStaff('waiter',['佩奇', 1000]) as Waiter;\r\n    let cook = Staff.getStaff('cook', ['海绵宝宝', 0]) as Cook;\r\n    let cook2 = Staff.getStaff('cook', ['阿秒小姐', 9999]) as Cook;\r\n    let cook3 = Staff.getStaff('cook', ['小当家', 0]) as Cook;\r\n\r\n    let orderedCustomerQueue = new Queue<Customer>();\r\n    let cookQueue = new Queue<Cook>();\r\n    let orderQueue = new Queue<Order>();\r\n    let freeWaiterQueue = new Queue<Waiter>();\r\n    let finishedDishQueue = new Queue<{dish: Dish, customer: Customer}>();\r\n\r\n    let infoEl = document.querySelector('#info');\r\n    orderedCustomerQueue.showIn(infoEl, '正在要求点菜的顾客队列');\r\n    cookQueue.showIn(infoEl, '空闲厨师队列');\r\n    orderQueue.showIn(infoEl, '订单队列');\r\n    freeWaiterQueue.showIn(infoEl, '空闲侍者队列');\r\n    finishedDishQueue.showIn(infoEl, '已完成菜品队列');\r\n\r\n    waiter2.setFinishedDishQueue(finishedDishQueue);\r\n    waiter.setFinishedDishQueue(finishedDishQueue);\r\n\r\n    cook.setFinishedDishQueue(finishedDishQueue);\r\n    cook2.setFinishedDishQueue(finishedDishQueue);\r\n    cook3.setFinishedDishQueue(finishedDishQueue);\r\n\r\n    cookQueue.add(cook);\r\n    cookQueue.add(cook2);\r\n    cookQueue.add(cook3);\r\n    freeWaiterQueue.add(waiter);\r\n    freeWaiterQueue.add(waiter2);\r\n    orderedCustomerQueue.add(customer.order('fish', 'duck'));\r\n    orderedCustomerQueue.add(customer1.order('蛋黄酱', '蛋黄酱', '蛋黄酱', '蛋黄酱', '蛋黄酱'));\r\n    orderedCustomerQueue.add(customer2.order('肉', '肉', '肉', '肉', '肉', '肉'));\r\n\r\n    let nameEl = document.querySelector('#name') as any;\r\n    let dishEl = document.querySelector('#dishes') as any;\r\n    let btn = document.querySelector('#btn');\r\n    btn.addEventListener('click', function() {\r\n        let c = new Customer(nameEl.value);\r\n        let dishes: string[] = dishEl.value.split(' ');\r\n        c.order(...dishes);\r\n        orderedCustomerQueue.add(c);\r\n    });\r\n\r\n    (function wrap(time = timeRatio) {\r\n        setTimeout(function() {\r\n            // log('开始运作');\r\n        while(!freeWaiterQueue.isEmpty()) {\r\n            log('while1')\r\n            if(!orderedCustomerQueue.isEmpty()) {\r\n                log('debug1')\r\n                let waiter = freeWaiterQueue.offer();\r\n                let customer = orderedCustomerQueue.offer();\r\n                let order = customer.getOrder();\r\n                log(waiter.name + '准备' + customer.name + '的点餐');\r\n\r\n                waiter.takeOrder(order)\r\n                .then(function(arg) {\r\n                    //0.5 服务生通知厨师去上菜\r\n                    waiter.writeDownOrder(orderQueue)\r\n                    .then(function() {\r\n                        waiter.setStatus('空闲中');\r\n                        freeWaiterQueue.add(waiter);\r\n                    });\r\n                });\r\n              \r\n            } else {\r\n                //没有要点菜的顾客\r\n                log('debug2');\r\n                if(!finishedDishQueue.isEmpty()) {    //判断是否有要上的菜\r\n                    log('debug3')\r\n                    let waiter = freeWaiterQueue.offer();\r\n                    waiter.setStatus('准备上菜中');\r\n                    let dish = finishedDishQueue.offer();                    \r\n                    waiter.moveToServeBar(0.5)      //0.5s移动到服务台端菜\r\n                    .then(function() {\r\n                        let customer = dish.customer;\r\n                        waiter.setStatus(customer.name + '的' + dish.dish.name);\r\n                        log('cus', customer.getPosition());\r\n                        waiter.moveTo(customer.getPosition(), 1);\r\n                        return new Promise(function(resolve) {  //0.5s送到顾客哪里\r\n                            setTimeout(() => {\r\n                                resolve(dish.dish);\r\n                            }, 1 * timeRatio);\r\n                        })\r\n                    })\r\n                    .then(function(dish: Dish) {\r\n                        log('dish', dish)\r\n                        customer.getDish(dish);\r\n                        waiter.setStatus('空闲中');\r\n                        waiter.moveToServeBar()\r\n                        freeWaiterQueue.add(waiter);                        \r\n\r\n                    });\r\n                } else {\r\n                    log('debug4')\r\n                    //没有要上的菜和要点菜的顾客\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        while(!orderQueue.isEmpty()) {\r\n            log('while2')\r\n            if(!cookQueue.isEmpty()) {\r\n                let order = orderQueue.offer();\r\n                \r\n                let cook = cookQueue.offer();\r\n                cook.makeDish(order)\r\n                .then(() => {\r\n                    log('完成一个订单');\r\n                    cookQueue.add(cook);\r\n                });\r\n            } else {\r\n                log('没有空闲厨师');\r\n                break;\r\n            }\r\n        }\r\n            wrap();\r\n        }, time);\r\n    })();\r\n}\r\n\r\n\r\nmain();\r\n"]}